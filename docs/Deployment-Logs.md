# Deployment Logs
Relevant source files
- [contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json)
- [contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json)
- [contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json)

## Purpose and Scope

This document explains the structure and contents of deployment logs generated by Foundry's `forge script` command during contract deployment. These logs provide an immutable audit trail of all deployment transactions, including contract addresses, transaction hashes, gas usage, and deployment parameters. They are stored as JSON files in the `contracts/broadcast/` directory.

For information about the deployment scripts that generate these logs, see [Deployment Scripts](/HACK3R-CRYPTO/Aegis/3.1-deployment-scripts). For network configuration details, see [Network Configuration](/HACK3R-CRYPTO/Aegis/3.2-network-configuration).

**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json1-46](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L1-L46)[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json1-50](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L1-L50)[contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json1-58](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json#L1-L58)

---

## Log File Location and Naming Convention

Deployment logs are stored in a hierarchical directory structure under `contracts/broadcast/`:

```
contracts/broadcast/
├── 04_DeployOracle.s.sol/
│   └── 11155111/
│       └── run-1769586193733.json
├── 05_DeploySentinel.s.sol/
│   └── 5318007/
│       └── run-1769588622425.json
└── 06_DeployHook.s.sol/
    └── 1301/
        └── run-1769587735298.json

```

The directory hierarchy follows the pattern:

- `{ScriptName}.s.sol/` - The deployment script filename
- `{ChainID}/` - The numeric chain ID of the target network
- `run-{UnixTimestamp}.json` - The deployment log with Unix timestamp

ScriptChain IDNetworkExample Filename`04_DeployOracle.s.sol``11155111`Ethereum Sepolia`run-1769586193733.json``05_DeploySentinel.s.sol``5318007`Reactive Kopli`run-1769588622425.json``06_DeployHook.s.sol``1301`Unichain Sepolia`run-1769587735298.json`
**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json1](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L1-L1)[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json1](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L1-L1)[contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json1](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json#L1-L1)

---

## JSON Structure Overview

Each deployment log is a JSON object containing five main sections:

```
Deployment Log JSON

transactions[]
Transaction specifications

receipts[]
On-chain execution results

libraries[]
Linked library addresses

pending[]
Unconfirmed transactions

Metadata
timestamp, chain, commit

Transaction Data
hash, contractName, arguments

Transaction Params
from, gas, value, nonce

Execution Status
status, gasUsed

Block Information
blockHash, blockNumber

Contract Address
contractAddress
```

**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json1-46](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L1-L46)[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json1-50](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L1-L50)

---

## Transaction Records

The `transactions` array contains specifications for each deployment transaction before execution.

### Transaction Object Structure

```
Transaction Object

Identification
hash: 0x3a084a0a...
transactionType: CREATE/CREATE2
contractName: MockOracle

Constructor
function: null
arguments: [0x0000...]

Transaction Details
from: 0xd2df53d9...
gas: 0x41bce
value: 0x0
input: 0x6080604052...
nonce: 0x123
chainId: 0xaa36a7

Metadata
additionalContracts: []
isFixedGasLimit: false
```

### Key Fields
FieldTypeDescriptionExample`hash``string`Transaction hash on-chain`"0x3a084a0a..."``transactionType``string`Deployment method: `"CREATE"` or `"CREATE2"``"CREATE"``contractName``string`Name of the deployed contract`"MockOracle"``contractAddress``string`Deterministic address where contract will be deployed`"0x29f8f8d2a00330f9683e73a926f61ae7e91cba3b"``arguments``array|null`Constructor arguments (ABI-encoded in `input` field)`null` or `["0x0000...", "0xBaa0..."]``transaction.from``string`Deployer address`"0xd2df53d9791e98db221842dd085f4144014bbe2a"``transaction.gas``string`Gas limit (hex)`"0x41bce"` (268238 decimal)`transaction.input``string`Contract bytecode + constructor args`"0x6080604052..."``transaction.nonce``string`Transaction nonce (hex)`"0x123"` (291 decimal)`transaction.chainId``string`Target chain ID (hex)`"0xaa36a7"` (11155111 decimal)
### CREATE vs CREATE2

The Aegis deployment demonstrates both deployment methods:

**CREATE (Oracle, Sentinel):**

- Address derived from deployer address and nonce
- [contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json5](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L5-L5) shows `"transactionType": "CREATE"`

**CREATE2 (Hook):**

- Address derived from deployer, salt, and bytecode hash
- [contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json5](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json#L5-L5) shows `"transactionType": "CREATE2"`
- Required for `AegisHook` to obtain address with `BEFORE_SWAP` flag (`0x80...`)
- Uses `to: "0x4e59b44847b379578588920ca78fbf26c0b4956c"` (deterministic deployer contract)

**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json2-20](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L2-L20)[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json2-24](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L2-L24)[contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json2-24](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json#L2-L24)

---

## Receipt Records

The `receipts` array contains on-chain execution results after transactions are mined.

### Receipt Object Structure

```
Receipt Object

Execution Status
status: 0x1
type: 0x0/0x2

Gas Metrics
gasUsed: 0x32915
effectiveGasPrice: 0x3919ff60
cumulativeGasUsed: 0x38cf72a

Block Context
blockHash: 0xfea675d5...
blockNumber: 0x9ab972
transactionIndex: 0x48

Contract Info
from: 0xd2df53d9...
to: null (CREATE)
contractAddress: 0x29f8f8d2...

Event Logs
logs: []
logsBloom: 0x000...

L2-Specific Fields
blobGasUsed
l1Fee
l1GasUsed
```

### Core Receipt Fields
FieldTypeDescriptionExample`status``string``"0x1"` (success) or `"0x0"` (failure)`"0x1"``transactionHash``string`Transaction hash`"0x3a084a0a..."``blockHash``string`Block hash containing this transaction`"0xfea675d5..."``blockNumber``string`Block number (hex)`"0x9ab972"` (10139698 decimal)`gasUsed``string`Gas consumed by this transaction (hex)`"0x32915"` (206101 decimal)`effectiveGasPrice``string`Actual gas price paid (hex, in wei)`"0x3919ff60"` (960855904 wei)`from``string`Sender address`"0xd2df53d9791e98db221842dd085f4144014bbe2a"``to``string|null`Recipient (null for contract creation)`null``contractAddress``string|null`Deployed contract address (for CREATE)`"0x29f8f8d2..."``type``string`Transaction type: `"0x0"` (legacy), `"0x2"` (EIP-1559)`"0x2"`
**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json22-39](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L22-L39)[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json26-43](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L26-L43)

---

## Network-Specific Differences

Deployment receipts vary across networks due to different consensus mechanisms and fee structures.

### Comparison Table
FieldSepolia (L1)Reactive NetworkUnichain Sepolia (L2)Chain ID`11155111``5318007``1301`Transaction Type`0x2` (EIP-1559)`0x0` (Legacy)`0x0` (Legacy)`blobGasUsed`Not presentNot present`"0x1cafc0"``l1Fee`Not presentNot present`"0x449aa04dabc"``l1GasUsed`Not presentNot present`"0x125c5"``l1GasPrice`Not presentNot present`"0x3c69045d"``l1BlobBaseFee`Not presentNot present`"0x404710a2"``daFootprintGasScalar`Not presentNot present`"0x190"`
### Unichain L2-Specific Fields

Unichain (Optimism-based L2) includes additional fields for tracking L1 data availability costs:

```
Unichain Receipt

L2 Execution
gasUsed: 0x15bd2f
effectiveGasPrice: 0x16e360

Blob Gas
blobGasUsed: 0x1cafc0

L1 DA Cost
l1Fee: 0x449aa04dabc
l1GasUsed: 0x125c5
l1GasPrice: 0x3c69045d

Cost Scalars
l1BaseFeeScalar: 0x7d0
l1BlobBaseFeeScalar: 0xdbba0
daFootprintGasScalar: 0x190
```

**Key L2 Fields:**

- `blobGasUsed`: Gas units for blob storage (EIP-4844)
- `l1Fee`: Total L1 data availability fee paid (in wei)
- `l1GasUsed`: Estimated L1 gas for posting transaction data
- `l1GasPrice`: L1 gas price at time of transaction
- `l1BlobBaseFee`: Blob base fee on L1
- Scalars: Multipliers for fee calculation

**Sources:**[contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json26-51](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json#L26-L51)

---

## Extracting Deployed Contract Addresses

```
Yes

No

Success

Failure

Extract Contract Address

Method 1: Transaction Object
transactions[0].contractAddress

Method 2: Receipt Object
receipts[0].contractAddress

transactionType == CREATE2?

Not in receipt
Only in transaction

In receipt.contractAddress

status == 0x1?

Use contractAddress

contractAddress == null
```

### Extraction Pattern by Deployment Type

**For CREATE deployments (Oracle, Sentinel):**

1. Check `receipts[0].status == "0x1"` (success)
2. Read `receipts[0].contractAddress`
3. Verify it matches `transactions[0].contractAddress`

Example from Oracle deployment:

```
{
  "transactions": [{"contractAddress": "0x29f8f8d2a00330f9683e73a926f61ae7e91cba3b"}],
  "receipts": [{"contractAddress": "0x29f8f8d2a00330f9683e73a926f61ae7e91cba3b"}]
}
```

**For CREATE2 deployments (Hook):**

1. Read `transactions[0].contractAddress` (deterministic)
2. Note: `receipts[0].contractAddress` will be `null` for CREATE2
3. Verify `receipts[0].to` matches deterministic deployer contract

Example from Hook deployment:

```
{
  "transactions": [{"contractAddress": "0xbaa0573e3be4291b58083e717e9ef5051772c080"}],
  "receipts": [{"contractAddress": null, "to": "0x4e59b44847b379578588920ca78fbf26c0b4956c"}]
}
```

**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json7-37](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L7-L37)[contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json7-42](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json#L7-L42)

---

## Deployment Metadata

Each log file includes metadata fields at the root level:
FieldTypeDescriptionExample`timestamp``number`Unix timestamp of deployment (milliseconds)`1769586193733``chain``number`Numeric chain ID`11155111``commit``string`Git commit hash at deployment time`"08ea552"``libraries``array`Linked library addresses (usually empty)`[]``pending``array`Unconfirmed transactions (empty after mining)`[]``returns``object`Return values from deployment functions`{}`
### Converting Timestamp

The timestamp is in Unix milliseconds. To convert to human-readable format:

```
# Using date command (macOS/Linux)
date -d @$(echo "1769586193733 / 1000" | bc)

# Using JavaScript
new Date(1769586193733)
```

**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json40-46](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L40-L46)[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json44-50](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L44-L50)

---

## Complete Deployment Audit Trail

The three deployments form a sequential audit trail across networks:

```
Network Deployments

Aegis Deployment Sequence

Monitored by

Controls

04_DeployOracle.s.sol
Timestamp: 1769586193733
Commit: 08ea552

05_DeploySentinel.s.sol
Timestamp: 1769588622425
Commit: 08ea552

06_DeployHook.s.sol
Timestamp: 1769587735298
Commit: 08ea552

Sepolia (11155111)
MockOracle
0x29f8f8d2a00330f9683e73a926f61ae7e91cba3b

Reactive (5318007)
AegisSentinel
0x0f764437ffbe1fcd0d0d276a164610422710b482

Unichain (1301)
AegisHook
0xbaa0573e3be4291b58083e717e9ef5051772c080
```

All deployments were executed from the same deployer address (`0xd2df53d9791e98db221842dd085f4144014bbe2a`) at the same git commit (`08ea552`), ensuring version consistency.

**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json7-45](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L7-L45)[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json7-49](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L7-L49)[contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json7-57](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json#L7-L57)

---

## Using Deployment Logs

### Verifying Deployment Success

```
# Check all deployments succeeded
jq '.receipts[0].status' contracts/broadcast/*/*/run-*.json

# Expected output: "0x1" for each file
```

### Extracting All Contract Addresses

```
# Extract addresses with contract names
for file in contracts/broadcast/*/*/run-*.json; do
  echo "$(basename $(dirname $(dirname $file))):"
  jq -r '.transactions[0] | "\(.contractName): \(.contractAddress)"' $file
done
```

### Calculating Total Gas Costs

```
# Calculate gas cost for each deployment
jq -r '.receipts[0] | 
  (.gasUsed | tonumber) * (.effectiveGasPrice | tonumber) / 1e18 | 
  "Gas cost: \(.) ETH"' contracts/broadcast/*/*/run-*.json
```

### Verifying Cross-Chain Configuration

The Sentinel deployment log contains constructor arguments that reference other contracts:

```
# Extract Sentinel constructor arguments
jq '.transactions[0].arguments' \
  contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-*.json

# Output:
# [
#   "0x0000000000000000000000000000000000fffFfF",  # Reactive system contract
#   "0xBaa0573e3BE4291b58083e717E9EF5051772C080",  # AegisHook address (Unichain)
#   "0x29f8f8d2A00330F9683e73a926F61AE7E91cBA3b"   # MockOracle address (Sepolia)
# ]
```

This confirms the Sentinel was configured with the correct cross-chain contract addresses.

**Sources:**[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json9-13](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L9-L13)

---

## Log Retention and Version Control

The `.gitignore` configuration excludes most build artifacts but **includes** deployment logs:

```
# contracts/.gitignore includes broadcast/ logs
!/broadcast

```

This ensures:

- Deployment logs are committed to version control
- Historical deployment data is preserved
- Contract addresses can be traced across deployments
- Audit trail remains intact

However, individual run files may be selectively ignored for development deployments while production deployment logs are committed.

**Sources:**[contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json1](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/04_DeployOracle.s.sol/11155111/run-1769586193733.json#L1-L1)[contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json1](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/05_DeploySentinel.s.sol/5318007/run-1769588622425.json#L1-L1)[contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json1](https://github.com/HACK3R-CRYPTO/Aegis/blob/5ea5ecc2/contracts/broadcast/06_DeployHook.s.sol/1301/run-1769587735298.json#L1-L1)